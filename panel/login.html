<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Logowanie – Panel serwisanta</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
  :root{
    --accent:#2563eb;
    --accentHover:#1d4ed8;
    --bg:#020617;
    --text:#e5e7eb;

    --panel: rgba(255,255,255,0.05);
    --panelBorder: rgba(255,255,255,0.10);
    --muted: rgba(229,231,235,0.7);
  }

  *{ box-sizing:border-box; }

  body{
    margin:0;
    font-family: Arial, sans-serif;
    background:
      radial-gradient(circle at top, rgba(37,99,235,0.18), transparent 45%),
      radial-gradient(circle at bottom, rgba(255,255,255,0.06), transparent 45%),
      var(--bg);
    color: var(--text);
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
  }

  .box{
    width:100%;
    max-width:420px;
    background: var(--panel);
    border: 1px solid var(--panelBorder);
    border-radius: 16px;
    padding: 28px;
    box-shadow: 0 18px 70px rgba(0,0,0,0.45);
    position:relative;
    overflow:hidden;
  }

  .box:before{
    content:"";
    position:absolute;
    inset:-2px;
    background: radial-gradient(circle at 20% 0%, rgba(37,99,235,0.18), transparent 40%);
    pointer-events:none;
  }

  .head{
    position:relative;
    display:flex;
    align-items:center;
    gap:10px;
    justify-content:center;
    margin-bottom:18px;
  }

  .logo{
    width:40px;
    height:40px;
    border-radius:12px;
    display:flex;
    align-items:center;
    justify-content:center;
    border:1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.03);
    color: var(--accent);
    flex:0 0 auto;
  }

  h1{
    position:relative;
    margin:0;
    text-align:center;
    font-size:20px;
    font-weight:900;
    letter-spacing:.2px;
  }

  .sub{
    position:relative;
    margin:-6px 0 16px;
    text-align:center;
    color: var(--muted);
    font-size:12px;
    font-weight:700;
  }

  .field{
    position:relative;
    margin-bottom:12px;
  }

  .field i{
    position:absolute;
    left:12px;
    top:50%;
    transform:translateY(-50%);
    opacity:.75;
    color:#0b1225;
    pointer-events:none;
  }

  input{
    width:100%;
    padding: 13px 14px 13px 38px;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.14);
    background: rgba(255,255,255,0.92);
    color:#000; /* ✅ czarny tekst w polach */
    font-size: 15px;
    outline:none;
  }

  input:focus{
    border-color: rgba(37,99,235,0.55);
    box-shadow: 0 0 0 3px rgba(37,99,235,0.16);
  }

  button{
    width:100%;
    padding: 14px 16px;
    border-radius: 999px;
    border: 2px solid var(--accent);
    background: var(--accent);
    color: #fff;
    font-weight: 900;
    cursor: pointer;
    font-size: 15px;
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap:10px;
    position:relative;
  }

  button:hover{ background: var(--accentHover); }

  button:disabled{
    opacity:.75;
    cursor:not-allowed;
  }

  .error{
    min-height:18px;
    margin-top: 10px;
    text-align: center;
    font-size: 13px;
    font-weight:800;
    color: #f87171;
    position:relative;
  }

  .hint{
    margin-top: 14px;
    text-align: center;
    font-size: 12px;
    color: var(--muted);
    position:relative;
  }

  .hint a{
    color: #fff;
    text-decoration:none;
    font-weight:900;
    opacity:.9;
  }
  .hint a:hover{ color: var(--accent); }

  @media(max-width:420px){
    .box{ padding:22px; }
  }
</style>
</head>

<body>

<div class="box">
  <div class="head">
    <div class="logo" aria-hidden="true"><i class="fa-solid fa-user-gear"></i></div>
    <h1>Panel serwisanta</h1>
  </div>

  <div class="sub">Zaloguj się, aby przejść do panelu</div>

  <div class="field">
    <i class="fa-solid fa-envelope"></i>
    <input id="email" type="email" placeholder="Email" autocomplete="username">
  </div>

  <div class="field">
    <i class="fa-solid fa-lock"></i>
    <input id="password" type="password" placeholder="Hasło" autocomplete="current-password">
  </div>

  <button id="loginBtn" type="button">
    <i class="fa-solid fa-right-to-bracket"></i> Zaloguj się
  </button>

  <div class="error" id="error"></div>

  <div class="hint">
    <a href="index.html"><i class="fa-solid fa-arrow-left"></i> Wróć na stronę główną</a>
  </div>
</div>

<script>
  const SUPABASE_URL = "https://mzgvxlltlcrvzmtswzql.supabase.co";
  const SUPABASE_ANON_KEY = "sb_publishable_u6iZP_f82VIoPc450syj4A_fhWmi9Nr";

  const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  const emailEl = document.getElementById("email");
  const passEl = document.getElementById("password");
  const btnEl = document.getElementById("loginBtn");
  const errorEl = document.getElementById("error");

  // Jeśli już zalogowany → od razu do panel.html
  (async () => {
    const { data: { session } } = await supabaseClient.auth.getSession();
    if (session) window.location.href = "panel.html";
  })();

  async function doLogin() {
    const email = emailEl.value.trim();
    const password = passEl.value;

    errorEl.textContent = "";

    if (!email || !password) {
      errorEl.textContent = "Podaj email i hasło";
      return;
    }

    btnEl.disabled = true;
    btnEl.textContent = "Logowanie...";

    const { error } = await supabaseClient.auth.signInWithPassword({ email, password });

    btnEl.disabled = false;
    btnEl.textContent = "Zaloguj się";

    if (error) {
      errorEl.textContent = "Błędny email lub hasło";
      return;
    }

    window.location.href = "panel.html";
  }

  btnEl.addEventListener("click", doLogin);

  // Enter w polu hasła też loguje
  passEl.addEventListener("keydown", (e) => {
    if (e.key === "Enter") doLogin();
  });
</script>

</body>
</html>